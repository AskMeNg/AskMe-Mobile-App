var tour=angular.module("tour",["ui.bootstrap"]);tour.directive("onFinishRender",function(t){return{restrict:"A",link:function(e){e.$last===!0&&t(function(){e.$emit("ngRepeatFinished")})}}}),tour.controller("tour",["$scope","searchData","toursRs","$location",function(t,e,a,o){t.getData=e.data(),t.tour=[],t.offer="",t.tour_atten=[1,[]],t.adult_no=t.tour_atten[0],t.child_no=t.tour_atten[1].length,t.pickupType="select",t.destinationType="select",t.tourType="transferOnly",t.touroptions="toursO",t.returnType="Y",t.d_hr="10",t.d_min="45",t.t_hr="12",t.t_min="45",t.r_hr="11",t.r_min="45",t.hp_city="",t.hd_city="",t.returntrans=[{name:"Yes, Please",value:"Y"},{name:"Don't Bother",value:"N"}],t.am_pm=[{name:"AM",value:"0"},{name:"PM",value:"12"}],t.locationtype=[{name:"Select Type",value:"select"},{name:"Terminal(Airport, Bus Station etc.)",value:"Terminal"},{name:"Hotel",value:"Hotel"}],t.setfromdate=function(){$("#s_date").focus()},t.settodate=function(){$("#e_date").focus()},t.f_tday=moment().add(3,"days").format("YYYYMMDD"),$fday=moment().add(3,"days").format("DD/MMMM/YYYY"),t.getData[22].valueData=t.f_tday,$f=$fday.split("/"),t.f_day=$f[0],t.f_month=$f[1],t.f_year=$f[2],t.fl_tday=moment().add(3,"days").format("ddd Do, MMM, YYYY"),t.t_tday=moment().add(4,"days").format("YYYYMMDD"),$nextday=moment().add(4,"days").format("DD/MMMM/YYYY"),t.getData[23].valueData=t.f_tday,$t=$nextday.split("/"),t.t_day=$t[0],t.t_month=$t[1],t.t_year=$t[2],t.tl_tday=moment().add(4,"days").format("ddd Do, MMM, YYYY"),t.setTourTransfer=function(e){"toursO"==e&&(t.getData[28]=t.tour_atten,o.path("/tours/globalTours")),"transferO"==e&&(t.getData[28]=t.tour_atten,t.getData[9].valueName=t.returnType,t.getData[22].valueName=t.t_hr+t.t_min,t.getData[23].valueName=t.d_hr+t.d_min,o.path("/tours/globalTransfer"))},$("#tour_complete").autocomplete({source:"server/hotel_autocomplete.php",minLength:3,select:function(e,a){var o=a.item.id,n=a.item.value;"#"!=o&&(t.getData[20].valueData=o,t.getData[21].valueData=n)},html:!0,open:function(){jQuery(".ui-autocomplete").css("z-index",1e3)}}),$("#transfer_hd_complete").autocomplete({source:"server/hotel_autocomplete.php",minLength:3,select:function(e,a){{var o=a.item.id;a.item.value}"#"!=o&&(t.hd_city=o)},html:!0,open:function(){jQuery(".ui-autocomplete").css("z-index",1e3)}}),$("#transfer_hp_complete").autocomplete({source:"server/hotel_autocomplete.php",minLength:3,select:function(e,a){{var o=a.item.id;a.item.value}"#"!=o&&(t.hp_city=o)},html:!0,open:function(){jQuery(".ui-autocomplete").css("z-index",1e3)}}),$("#transfer_complete_2").autocomplete({source:function(e,a){$.getJSON("server/transfer_autocomplete.php",{term:e.term,type:t.destinationType,dest_code:t.hd_city},a)},minLength:3,select:function(e,a){var o=a.item.id,n=a.item.value;"#"!=o&&(t.getData[8].valueData=o,t.getData[9].valueAirport=n,t.getData[9].valueTown=t.hd_city,t.getData[9].valueCountry=t.destinationType)},html:!0,open:function(){jQuery(".ui-autocomplete").css("z-index",1e3)}}),$("#transfer_complete").autocomplete({source:function(e,a){$.getJSON("server/transfer_autocomplete.php",{term:e.term,type:t.pickupType,dest_code:t.hp_city},a)},minLength:3,select:function(e,a){var o=a.item.id,n=a.item.value;"#"!=o&&(t.getData[5].valueData=o,t.getData[6].valueAirport=n,t.getData[6].valueTown=t.hp_city,t.getData[6].valueCountry=t.pickupType)},html:!0,open:function(){jQuery(".ui-autocomplete").css("z-index",1e3)}})}]),tour.directive("tdateFrom",function(){return function(t,e){e.datepicker({defaultDate:"+1w",dateFormat:"dd/MM/yy",minDate:0,changeMonth:!0,numberOfMonths:3,onClose:function(e){var a=$(this).datepicker("getDate");a&&a.setDate(a.getDate()+1),$("#r_date").datepicker("option","minDate",a||1);var o=e.split("/");t.f_day=o[0],t.f_month=o[1],t.f_year=o[2],t.getData[7].valueData=moment(e).format("YYYYMMDD"),t.getData[12].valueData=moment().format("ddd Do, MMM, YYYY"),t.d_checkin=moment(e).format("YYYY-MM-DD"),$num=t.get_days(),t.getData[11].valueData=$num,t.$apply(),$("#r_date").focus()}})}}),tour.directive("tdateTo",function(){return function(t,e){e.datepicker({dateFormat:"dd/MM/yy",changeMonth:!0,numberOfMonths:3,onClose:function(e){$("#d_date").datepicker("option","maxDate",e);var a=e.split("/");t.t_day=a[0],t.t_month=a[1],t.t_year=a[2],t.getData[10].valueData=moment(e).format("YYYYMMDD"),t.getData[13].valueData=moment().format("ddd Do, MMM, YYYY"),t.d_checkout=moment(e).format("YYYY-MM-DD"),$num=t.get_days(),t.getData[11].valueData=$num,t.$apply()}})}});