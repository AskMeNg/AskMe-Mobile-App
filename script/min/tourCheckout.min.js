var tourCheckout=angular.module("tourCheckout",["ui.bootstrap"]);tourCheckout.directive("onFinishRender",function(e){return{restrict:"A",link:function(t){t.$last===!0&&e(function(){t.$emit("ngRepeatFinished")})}}}),tourCheckout.controller("tourCheckout",["$scope","searchData","tourData","purchaseData","serviceAddRs","$location",function(e,t,r,o,a,u){e.getData=t.data(),e.getTour=r.data(),e.adultGuest=e.getTour[0][2][0],e.purchaseD=o.data(),e.purchaseT="none",null!=e.purchaseD[0]&&(e.purchaseT=e.purchaseD[0]["@purchaseToken"]),console.log(e.getTour),e.tservAdd=a.get({Availtoken:e.getData[26].availToken,contractName:e.getTour[0][0].ContractList.Contract.Name,contractCode:e.getTour[0][0].ContractList.Contract.IncomingOffice["@code"],pToken:e.purchaseT,ServiceType:"ServiceTicket",tourBreakDown:JSON.stringify(e.getData[28]),Guest:JSON.stringify(e.getTour[0][2]),DateFrom:e.getTour[0][0].DateFrom["@date"],DateTo:e.getTour[0][0].DateFrom["@date"],currency:e.getTour[0][0].Currency["@code"],ticketcode:e.getTour[0][0].TicketInfo.Code,destcode:e.getTour[0][0].TicketInfo.Destination["@code"],availcode:e.getTour[0][0].AvailableModality["@code"],availName:e.getTour[0][0].AvailableModality.Name,availContactName:e.getTour[0][0].AvailableModality.Contract.Name,availContactcode:e.getTour[0][0].AvailableModality.Contract.IncomingOffice["@code"],tourAdult:e.getTour[0][0].Paxes.AdultCount,tourChild:e.getTour[0][0].Paxes.ChildCount},function(){function t(){Array.isArray(e.travelers)?(console.log("here"),"CH"!=e.travelers[a]["@type"]?e.lead={user:e.travelers[0].CustomerId+"|"+e.adultGuest[0][0]}:(a++,t())):"CH"!=e.travelers["@type"]?(console.log("ok, here"),e.lead={user:e.travelers.CustomerId+"|"+e.adultGuest[0][0]}):(a++,t())}if(e.AddedtourServRs=e.tservAdd.ServiceAddRS.Purchase,e.service=e.AddedtourServRs.ServiceList.Service,null!=e.purchaseD[0]){var r=e.service.length;e.service=e.service[r-1]}console.log(e.service),o.setData(e.AddedtourServRs),e.travelers=e.service.Paxes.GuestList.Customer;var a=0;t()}),e.next=function(t,r){e.getTour[0].push(r.user),u.path(t)}}]);