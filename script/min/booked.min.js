var booked=angular.module("booked",["angular.filter","ui.bootstrap"]);booked.directive("onFinishRender",function(e){return{restrict:"A",link:function(t){t.$last===!0&&e(function(){t.$emit("ngRepeatFinished")})}}}),booked.controller("booked",["$scope","searchData","tourData","hotelData","transferData","purchaseConfirmRs","purchaseData","sendmailRS","userData",function(e,t,r,o,a,s,n,i,c){e.getData=t.data(),e.getTour=r.data(),e.getTransfer=a.data(),e.getHotel=o.data(),e.getPurchase=n.data(),console.log(e.getTour),console.log(e.getTransfer),console.log(e.getHotel),console.log(e.getPurchase),e.bookings=[""];var u=e.getPurchase.length;for(e.getPurchase=e.getPurchase[e.getPurchase.length-1],console.log(e.getPurchase),e.service=e.getPurchase.ServiceList.Service,console.log(e.service),$i=0;u>$i;$i++){if(console.log(e.service),u>1&&(e.service=e.getPurchase.ServiceList.Service[$i],console.log(e.service)),null!=e.getHotel[0]&&"ServiceHotel"==e.service["@xsi:type"]){e.bookings[0]=e.getPurchase["@purchaseToken"];var g=e.getHotel.length;e.hotel=[[],[],[],[]],e.hotel[0][0]=e.service["@xsi:type"],e.hotel[0][1]=e.service["@SPUI"],e.hotel[1]=e.getHotel[3],e.hotel[2]=e.getHotel[g-1],e.bookings.push(e.hotel)}if(null!=e.getTour[0]&&"ServiceTicket"==e.service["@xsi:type"]){e.bookings[0]=e.getPurchase["@purchaseToken"],e.tour=[[],[],[],[]];var g=e.getTour[0].length;e.tour[0][0]=e.service["@xsi:type"],e.tour[0][1]=e.service["@SPUI"],e.tour[1]=e.service.Paxes.GuestList.Customer,e.tour[2]=e.getTour[0][g-1],e.bookings.push(e.tour)}if(null!=e.getTransfer[0]["@availToken"]&&"ServiceTransfer"==e.service["@xsi:type"]){e.bookings[0]=e.getPurchase["@purchaseToken"],e.transfer=[[],[],[],[]];var g=e.getTransfer.length;e.transfer[0][0]=e.service["@xsi:type"],e.transfer[0][1]=e.service["@SPUI"],e.transfer[0][2]=e.service["@transferType"],e.transfer[1]=e.service.Paxes.GuestList.Customer,e.transfer[2]=e.getTransfer[g-1],e.transfer[3]=e.service.ArrivalTravelInfo,e.transfer[4]=e.service.DestinationLocation,e.transfer[5]=e.service.PickupLocation,e.transfer[6]=e.service.DepartureTravelInfo,e.bookings.push(e.transfer)}}e.transInfo=e.getTour[0],e.user=c.data()[1],console.log(e.bookings),e.hpurchaseConf=s.get({Data:JSON.stringify(e.bookings)},function(){e.AddedServRs=e.hpurchase,console.log(e.AddedServRs),n.setData(e.AddedServRs),e.sendbook=i.get({transfername:e.getTour[0].TourInfo.Name,transferAddress:e.getTour[0].TourInfo.Destination.ZoneList.Zone["@code"]+" "+e.getTour[0].TourInfo.Destination.ZoneList.Zone.$+" "+e.getTour[0].TourInfo.Destination.Name,hcheckin:e.getData[22].valueDataLong,hcheckout:e.getData[23].valueDataLong,Rooms:JSON.stringify(e.AddedServRs.PurchaseConfirmRS.Purchase.ServiceList.Service.AvailableRoom),References:JSON.stringify(e.AddedServRs.PurchaseConfirmRS.Purchase.ServiceList.Service.Reference),totalNight:e.getData[24].valueData,totalAdult:e.getData[17].valueData,totalChild:e.getData[18].valueData,totalRoom:e.getData[19].valueData,totalAmount:e.AddedServRs.PurchaseConfirmRS.Purchase.ServiceList.Service.TotalAmount,bookingCode:e.AddedServRs.PurchaseConfirmRS.Purchase["@purchaseToken"]},function(){e.user=e.sendbook,console.log(e.user)})})}]);