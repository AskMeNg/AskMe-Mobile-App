var tourList=angular.module("tourList",["ui.bootstrap"]);tourList.directive("onFinishRender",function(t){return{restrict:"A",link:function(e){e.$last===!0&&t(function(){e.$emit("ngRepeatFinished")})}}}),tourList.controller("tourList",["$scope","searchData","tourData","tourListRs",function(t,e,a,o){function l(){t.tList=o.get({hDesCode:t.getData[20].valueData,hTourin:t.getData[22].valueData,hTourout:t.getData[23].valueData,tourBreakDown:JSON.stringify(t.getData[28])},function(){t.tours_p=t.tList.TicketAvailRS,t.tours_total=t.tours_p["@totalItems"],console.log(t.tList),t.tours=t.tours_p.ServiceTicket,t.getData[26].availToken=t.tours[0]["@availToken"]})}t.getData=e.data(),t.getTour=a.data(),t.tourlist=[],t.offer="",l(),t.$on("ngRepeatFinished",function(){$(".scroller_container").jScrollPane()}),t.addTour=function(e){t.tourlist.push(e)},t.changeDest=function(){$(".t_head_mover").animate({top:-50})},t.searchDest=function(){t.tours.pop(),t.newtour=l(),$(".t_head_mover").animate({top:0}),t.changetours="change",$(".scroller_container").jScrollPane()},$("#tour_complete").autocomplete({source:"server/hotel_autocomplete.php",minLength:3,select:function(e,a){var o=a.item.id,l=a.item.value;"#"!=o&&(t.getData[20].valueData=o,t.getData[21].valueData=l)},html:!0,open:function(){jQuery(".ui-autocomplete").css("z-index",1e3)}})}]),tourList.controller("ModalCtrl",["$scope","tourValuationRs","searchData","$modal","$log",function(t,e,a,o){t.getData=a.data(),t.opentourDetails=function(a){t.temp_getTour=[],$code=a.TicketInfo.Code,$avail=a["@availToken"],$availModal=a.AvailableModality["@code"],null==$availModal&&($availModal=a.AvailableModality[0]["@code"]),t.tvList=e.get({tTicketCode:$code,tAvailToken:$avail,tAvailModal:$availModal,hDesCode:t.getData[20].valueData,hTourin:t.getData[22].valueData,hTourout:t.getData[23].valueData,tourBreakDown:JSON.stringify(t.getData[28])},function(){console.log(t.tvList),t.tours_tickets=t.tvList.TicketValuationRS.ServiceTicket,t.tavailTicket=t.tours_tickets.AvailableModality.PriceList.Price,t.temp_getTour.push(t.tvList.TicketValuationRS.ServiceTicket),console.log(t.temp_getTour)}),t.tour=a;o.open({templateUrl:"tourDetails.html",controller:"ModalInstanceCtrl",size:"lg",resolve:{tour:function(){return t.tour},tours:function(){return t.temp_getTour}}})}}]),tourList.controller("ModalInstanceCtrl",["$scope","tourValuationRs","tourData","$modalInstance","tour","tours",function(t,e,a,o,l,i){t.tour=l,t.tours=i,t.selectedTour=[],t.checktour=[],t.mainImageUrl=t.tour.TicketInfo.ImageList.Image[0].Url,t.selectedTours=function(e){1==t.checktour[e]&&(t.selectedTour.push(t.tours[e]),console.log(t.selectedTour))},t.setImage=function(e){t.mainImageUrl=e},t.move_right=function(){$fer=70*$(".hthumb").last().attr("name")-420,console.log($fer),$lef=Math.abs(parseInt($("#thumb_load").css("left"))),console.log($lef),$fer>=$lef?$("#thumb_load").animate({left:"-=70"},{duration:1e3,queue:!1}):$("#right_th").fadeOut(),$lef>-10&&$("#left_th").fadeIn()},t.move_right=function(){$lef=parseInt($("#thumb_load").css("left")),$lef>-80?$("#left_th").fadeOut():$("#right_th").fadeIn(),$("#thumb_load").animate({left:"+=70"},{duration:1e3,queue:!1})},t.ok=function(){if(0!=t.selectedTour.length){a.setData(t.selectedTour);var e=a.data(),l=e.length-1;a.addData(t.tour.TicketInfo.ImageList,l),console.log(a.data())}o.close()},t.cancel=function(){o.dismiss("cancel")}}]);