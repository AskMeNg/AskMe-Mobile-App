var AddGuest=angular.module("AddGuest",["angular.filter","ui.bootstrap"]);AddGuest.directive("onFinishRender",function(e){return{restrict:"A",link:function(t){t.$last===!0&&e(function(){t.$emit("ngRepeatFinished")})}}}),AddGuest.controller("AddGuest",["$scope","searchData","flightData","purchaseData","userData","travelPackD","Add_guest","$modal","$log","$location",function(e,t,a,i,l,s){function n(e,t,a){var i=new Date;i.setTime(i.getTime()+60*a*1e3);var l="expires="+i.toUTCString();document.cookie=e+"="+JSON.stringify(t)+"; "+l}function r(e){for(var t=e+"=",a=document.cookie.split(";"),i=0;i<a.length;i++){var l=a[i].trim();if(0==l.indexOf(t))return l.substring(t.length,l.length)}}function u(t){for(console.log(t),e.user=l.data()[1],e.def=e.user,e.totalPrice=0,$i=0;$i<t.length;$i++){if(e.flight_g=[],e.hotel_g=[],"Sabre"==t[$i].product&&"Flight"==t[$i].productType){for(e.flight_p={adult:[],child:[],seniors:[],infant:[]},$i=0;$i<t[$i].fAdult;$i++)guest={title:"",fname:"",lname:"",email:"",phone:"",dbirth:"",caddress:"",city:"",state:"",pcode:"",country:"",nationality:""},e.flight_p.adult.push(guest),0==$i&&(e.flight_p.adult[0]=e.def);for($i=0;$i<t[$i].fChild;$i++)guest={title:"",fname:"",lname:"",email:"",phone:"",dbirth:"",caddress:"",city:"",state:"",pcode:"",country:"",nationality:""},e.flight_p.child.push(guest),0==$i&&null==e.flight_p.adult&&(e.flight_p.child[0]=e.def);for($i=0;$i<t[$i].fSeniors;$i++)guest={title:"",fname:"",lname:"",email:"",phone:"",dbirth:"",caddress:"",city:"",state:"",pcode:"",country:"",nationality:""},e.flight_p.seniors.push(guest),0==$i&&null==e.flight_p.adult&&(e.flight_p.seniors[0]=e.def);for($i=0;$i<t[$i].fInfant;$i++)guest={title:"",fname:"",lname:"",email:"",phone:"",dbirth:"",caddress:"",city:"",state:"",pcode:"",country:"",nationality:""},e.flight_p.infant.push(guest),0==$i&&null==e.flight_p.infant&&(e.flight_p.infant[0]=e.def);console.log(e.flight_p),e.flight_g.push(e.flight_p),e.totalPrice=parseFloat(e.totalPrice)+parseFloat(t[$i].hPrice)}if("Hotelbeds"==t[$i].product&&"Hotel"==t[$i].productType){for($b=0;$b<t[$i].roomBreak.length;$b++){for(console.log(t[$i]),$roo=t[$i].hroomdist,e.room={comment:"",guest:[]},$a=0;$a<$roo[$b][1];$a++)guest={title:"",fname:"",lname:"",dbirth:""},e.room.guest.push(guest),0==$b&&(e.room.guest[0]={title:e.def.title,fname:e.def.fname,lname:e.def.lname,dbirth:e.def.dbirth});for($a=0;$a<$roo[$b][2].length;$a++)guest={title:"Child",fname:"",lname:"",dbirth:""},e.room.guest.push(guest);t[$i].roomBreak[$b].guest_details=e.room}e.hotel_g.push(e.hotel_d),t[$i].guest_details=e.hotel_d,console.log(t[$i]),e.totalPrice=parseFloat(e.totalPrice)+parseFloat(t[$i].hPrice)}}}e.guest=[],e.travelPD=s.data(),s.data().length<1?(e.travelPD=JSON.parse(r("travelPD")),u(e.travelPD)):u(e.travelPD),e.getData=t.data(),e.Reg_head="Y",e.hotel_Mguest={fName:e.user.fname,lName:e.user.lname},e.tour_Mguest={fName:e.user.fname,lName:e.user.lname},e.transfer_Mguest={fName:e.user.fname,lName:e.user.lname},e.nodefault=function(t){"N"==t?(e.flight_Mguest=null,e.hotel_Mguest=null,e.tour_Mguest=null,e.transfer_Mguest=null):(e.flight_Mguest=e.user,e.hotel_Mguest={fName:e.user.fname,lName:e.user.lname},e.tour_Mguest={fName:e.user.fname,lName:e.user.lname},e.transfer_Mguest={fName:e.user.fname,lName:e.user.lname})},e.txn_ref=Math.floor(1e7*Math.random())+1e7,e.pay_item_id=101,e.pay_item_name="adedokun olushola",e.amount=2e7,e.currency=566,e.site_redirect_url="https://www.getcentre.com/test.php#voucher",e.site_name="http://www.getcentre.com",e.cust_id=123,e.cust_id_desc="Personal",e.cust_name="Adedokun Olushola",e.cust_name_desc="Regular",e.local_date_time=moment().format("DD/MM/YYYY"),e.payOnlineData="product_id=6205&txn_ref="+e.txn_ref+"&pay_item_id=101&pay_item_name=Flight|Hotel&amount="+e.amount+"&currency="+e.currency+"&site_redirect_url="+e.site_redirect_url+"&site_name="+e.site_name+"&cust_id="+e.cust_id+"&cust_id_desc="+e.cust_id_desc+"&cust_name="+e.cust_name+"&cust_name_desc="+e.cust_name_desc+"&local_date_time="+e.local_date_time,e.save_the_hash=function(){window.location="https://www.getcentre.com/server/PayMentGatewayRQRS.php?"+e.payOnlineData,e.guest.push(e.flight_Mguest),e.guest.push(e.hotel_Mguest),e.guest.push(e.tour_Mguest),e.guest.push(e.transfer_Mguest),n("Guest",e.guest,30),web_auth={txn_ref:e.txn_ref,amount:e.amount,hasher:jQuery("#hash_hid").val()},n("webPay",web_auth,30)}}]);